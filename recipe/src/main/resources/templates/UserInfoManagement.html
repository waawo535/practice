<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ユーザ情報管理画面</title>
<link rel="stylesheet" th:href="@{/css/Header.css}">
<link rel="stylesheet" th:href="@{/css/UserInfoManagement.css}">
</head>
<body class="UserInfo">
<div th:replace="~{Header :: header}"  ></div>
<div class="container">
<div th:classappend="${#strings.isEmpty(UserInfoManagementDto.errormessageAreaList)} ? 'sidebar' : 'sidebar active'"  id="profileViewInf" th:object="${UserInfoManagementDto}">
    <div class="profile-img-container">
        <img id="profileImg" th:src="@{/img/home.png}" alt="プロフィール画像">
    </div>
    <div class="profile-item">
        <label>ユーザ名:</label>
        <span id="userName" th:text="*{userName}"></span>
    </div>
    <div class="profile-item">
        <label>Email:</label>
        <span id="emailAddress" th:text="*{emailAddress}"></span>
    </div>
    <div class="profile-item">
        <label>電話番号:</label>
        <span id="phoneNumber" th:text="*{phoneNumber}"></span>
    </div>
    <div class="profile-item">
        <label>自己紹介:</label>
        <span id="bio" th:text="*{bio}"></span>
    </div>
    <div class="profile-item">
        <label>誕生日:</label>
        <span id="birthDate" th:text="*{birthDate}"></span>
    </div>
    <div class="profile-item">
        <label>性別:</label>
        <span id="gender" th:text="*{gender}"></span>
    </div>
    <div class="profile-item">
        <label>登録日:</label>
        <span id="registerDate" th:text="*{registerDate}"></span>
    </div>
    <div class="profile-item">
        <label>更新日:</label>
        <span id="updateDate" th:text="*{updateDate}"></span>
    </div>
    <button class="edit-btn" onclick="showEditProfile()">プロフィールを編集</button>
</div>
<div th:classappend="${#strings.isEmpty(UserInfoManagementDto.errormessageAreaList)} ? 'main-content' : 'main-content active'" id="profileViewRec">
    <div class="recipes-container" id="recipesContainer">
        <h2>作成したレシピ一覧</h2>
        <div id="recipesList">
			<!-- レシピが1件もない場合 -->
			<div th:if="${#lists.isEmpty(UserInfoManagementDto.recipeList)}">
	            <p>作成したレシピがありません。</p>
	            <button class="create-btn" onclick="createRecipe()">レシピを作成する</button>
			</div>
			<!-- レシピが存在する場合 -->
	        <div th:if="${!#lists.isEmpty(UserInfoManagementDto.recipeList)}">
	            <ul class="recipe-list" id="recipe-list">
	                <!-- 各レシピをループで表示 -->
	                <li th:each="recipe : ${UserInfoManagementDto.recipeList}" class="recipe-item"
	                    th:onclick="'viewRecipeDetail(' + '${recipe.recipeId}' + ');'">
	                    
	                    <!-- レシピ画像 -->
						<div class="recipe-img" th:if="${!#strings.isEmpty(recipe.recipeImg) and !#strings.equals(recipe.recipeImg, '/img/')}">
	                    	<img th:src="@{${recipe.recipeImg}}" alt="レシピ画像" class="recipe-image">
						</div>
	                    <!-- レシピ情報 -->
	                    <div class="recipe-info">
	                        <h3 th:text="${recipe.recipeName}">レシピ名</h3>
	                        <p th:text="${recipe.recipeDescrip}">レシピ説明文</p>
	                        <p class="rating" th:text="'評価: ' + ${recipe.recipeAveRating}">現在の評価</p>
	                    </div>
	                    
	                    <!-- 編集・削除ボタン -->
	                    <div class="recipe-actions">
	                        <button class="edit-btn" 
	                            th:onclick="'event.stopPropagation(); editRecipe(' + '${recipe.recipeId}' + ');'">
	                            編集
	                        </button>
	                        <button class="delete-btn" 
	                            th:onclick="'event.stopPropagation(); deleteRecipe(' + '${recipe.recipeId}' + ');'">
	                            削除
	                        </button>
	                    </div>
	                </li>
	            </ul>
	        </div>
        </div>
    </div>
</div>
</div>
<div th:classappend="${#strings.isEmpty(errorMessage)} ? 'profile-edit' : 'profile-edit active'" id="profileEdit">
    <div class="main-content">
		<form id="profileEditForm" th:action="@{/UserInfoManagement/editUserInfo}"  th:object="${UserInfoManagementDto}" method="POST">
	        <h2>プロフィール編集</h2>
	        <div class="profile-item">
	            <label for="editUserName">ユーザ名:</label>
	            <input type="text" id="editUserName" placeholder="山田太郎" th:field="*{userName}">
	        </div>
	        <div class="profile-item">
	            <label for="editEmail">Email:</label>
	            <input type="email" id="editEmail" placeholder="taro.yamada@example.com" th:field="*{emailAddress}">
	        </div>
	        <div class="profile-item">
	            <label for="editPhoneNumber">電話番号:</label>
	            <input type="tel" id="editPhoneNumber" placeholder="080-1234-5678" th:field="*{phoneNumber}">
	        </div>
	        <div class="profile-item">
	            <label for="editBio">自己紹介:</label>
	            <input type="text" id="editBio" placeholder="料理が大好きなソフトウェアエンジニアです。" th:field="*{bio}">
	        </div>
	        <button class="edit-btn" onclick="showProfileView()">キャンセル</button>
	        <button type="submit" class="edit-btn">保存</button>
		</form>
    </div>
</div>

<script th:src="@{/js/Header.js}"></script>
<script th:src="@{/js/UserInfoManagement.js}"></script>
</body>
</html>